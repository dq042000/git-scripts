; #!/bin/bash

; echo "ğŸš€ æ­£åœ¨é€é GitHub Copilot é€²è¡Œè³‡æ·±é–‹ç™¼è€…ç­‰ç´šçš„è‡ªå‹•å¯©æŸ¥..."

; # å–å¾—å³å°‡ push çš„ commits ç¯„åœ
; remote="$1"
; url="$2"

; z40=0000000000000000000000000000000000000000

; has_changes=false

; while read local_ref local_sha remote_ref remote_sha
; do
;     if [ "$local_sha" = "$z40" ]; then
;         # åˆªé™¤åˆ†æ”¯ï¼Œè·³éæª¢æŸ¥
;         continue
;     elif [ "$remote_sha" = "$z40" ]; then
;         # æ–°åˆ†æ”¯ï¼Œæª¢æŸ¥æ‰€æœ‰ commits
;         range="$local_sha"
;     else
;         # æ›´æ–°åˆ†æ”¯ï¼Œæª¢æŸ¥å·®ç•°
;         range="$remote_sha..$local_sha"
;     fi
    
;     has_changes=true
;     break
; done

; if [ "$has_changes" = false ]; then
;     echo "â„¹ï¸  æ²’æœ‰éœ€è¦å¯©æŸ¥çš„è®Šæ›´"
;     exit 0
; fi

; # åŸ·è¡Œ Copilot å¯©æŸ¥å³å°‡ push çš„ commits
; gh copilot -p "è«‹æ‰®æ¼”è³‡æ·±é–‹ç™¼äººå“¡ï¼Œé‡å°å³å°‡ push çš„ commits (ç¯„åœ: $range) é€²è¡Œ Code Reviewã€‚è«‹æ¶µè“‹ï¼š1. æ‰¾å‡ºæ½›åœ¨ Bugã€‚2. æä¾›æ•ˆèƒ½å„ªåŒ–å»ºè­°ã€‚3. å»ºè­°æ›´ä¹¾æ·¨çš„ç¨‹å¼ç¢¼çµæ§‹æˆ–å‘½åæ–¹å¼ã€‚4. æª¢æŸ¥æ˜¯å¦æœ‰å®‰å…¨é¢¨éšªã€‚è«‹ä½¿ç”¨å°ç£ç¹é«”ä¸­æ–‡å›ç­”ï¼Œå…§å®¹è¦ç²¾ç°¡ä¸”å…·é«”ã€‚" --allow-tool 'shell(git)'

; echo ""
; echo "------------------------------------------------"
; read -p "çœ‹å®Œ Review äº†å—ï¼Ÿè¦ç¹¼çºŒ Push å—ï¼Ÿ(y/n): " confirm

; if [[ "$confirm" != "y" ]]; then
;     echo "âŒ Push å·²å–æ¶ˆï¼Œè«‹ä¿®æ­£å¾Œå†å˜—è©¦ã€‚"
;     exit 1
; fi

; exit 0